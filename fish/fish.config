set last_was_ctrl_c 0

if status is-interactive
    # Commands to run in interactive sessions can go here
end

function fish_prompt --description 'Write out the prompt'
    set -l last_status $status

    if [ $last_status -eq 0 ] && [ $last_was_ctrl_c -eq 0 ]
        set_color green
        echo -n ':)'
    else
        set_color red
        echo -n ':('
    end

    echo -n ' '
    
    set_color green
    echo -n "$USER@$hostname"
    
    set_color reset
    echo -n ':'
    set_color cyan
    echo -n (prompt_pwd --dir-length 0)
    parse_git_branch
    set_color reset
    echo -n '$ '
    set last_was_ctrl_c 0
end

function fish_user_key_bindings
  bind \cc 'echo; commandline ""; set last_was_ctrl_c 1; commandline -f repaint;'
end

function parse_git_branch
  set -l branch (git symbolic-ref --short HEAD 2>/dev/null)
  if [ -n "$branch" ]
    set_color yellow
    echo -n " ($branch)"
  end
end